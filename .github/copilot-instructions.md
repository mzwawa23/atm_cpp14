# AI Coding Agent Instructions for ATM C++14 Project

## Project Overview
This is a C++14 demonstration project implementing a simple ATM banking system with modern C++ features. The codebase integrates with **Parasoft C/C++test Standard** for static analysis, code coverage, and unit test generation.

## Architecture
The system follows a layered architecture with dependency injection:
- **ATM**: Main controller that coordinates between Bank and BaseDisplay
- **Bank**: Manages collections of accounts with authentication
- **Account**: Individual account with transactions (using C++14 features like `auto`, move semantics)
- **BaseDisplay**: Abstract interface for user interaction (polymorphic design)
- **UserRequest**: C++11 enum class for operation types

Key relationships:
- ATM depends on Bank (for account management) and BaseDisplay (for UI)
- Account stores transactions as `std::vector<std::tuple<UserRequest, double>>`
- Bank manages raw pointers to Account objects (legacy pattern)

## Build System & Tasks
The project uses **dual build systems**:

1. **CMake** (primary): `mkdir build && cd build && cmake .. && make`
2. **Legacy Makefile**: Creates static library `ATM_Cpp14_lib.a`

**Critical VS Code tasks** (use these instead of manual commands):
- "Configure and Build": Sets up CMake with C/C++test coverage integration
- "Run": Executes GoogleTest with XML output for test reporting
- "Compute logs and generate reports": Processes C/C++test coverage data

## C/C++test Integration (Essential)
This project is **tightly coupled with Parasoft C/C++test**:

**Coverage workflow**:
1. Build with `-DCPPTEST_COVERAGE=ON` (instruments code automatically)
2. Run tests to generate `.clog` files in `build/cpptest-coverage/`
3. Use `cpptestcov compute/report` to generate coverage reports in `.coverage/`

**Static analysis patterns**:
- Configuration files in `conf/` (e.g., "Recommended Rules.properties", "MISRA C++ 2023.properties")
- VS Code integration via `.vscode/settings.json` with `cpptest.testConfiguration`
- Suppression comments: `// parasoft-cov-begin-suppress ALL` and corresponding end tags

## Testing Strategy
**Dual testing approach**:
1. **GoogleTest** (manual): `tests/gt/` - developer-written tests with requirement tracing (`RecordProperty("req", "ATM-516")`)
2. **Auto-generated** (C/C++test): `tests/autogenerated/` - comprehensive boundary value tests

**Test utilities**:
- `TestObjectFactory`: Singleton pattern for creating test scenarios (e.g., `bankWithTwoAccounts()`)
- Tests include requirement traceability (ATM-XXX format)

## C++14 Patterns Used
The codebase demonstrates specific modern C++ features:
- **Move constructors**: `Account(Account&& a)` with `std::move()` for string/vector members
- **Auto return types**: `auto getBalance() const` and `auto getAccountNumber() const`
- **Defaulted/deleted functions**: `Account() = default`, copy operations `= delete`
- **Lambda expressions**: Transaction processing with captures `[this]`
- **Template functions**: `forEachTransaction<T>` with callable parameter

## Code Quality & MISRA Compliance
**Expected violation patterns**:
- Move constructors must be `noexcept` (MISRA C++ 2023)
- Classes with custom move operations need explicit destructors
- Function return values should not be discarded (use `(void)` cast for intentional discards)
- Classes should be in named namespaces, not global scope

**Suppression syntax**:
```cpp
// Parasoft: 
/* PRQA S rule_number */ // Reason
```

## Development Workflow
1. **Always use VS Code tasks** for build operations (they handle C/C++test integration)
2. **Run static analysis** via VS Code C/C++test extension or `cpptestcli` command line
3. **Check coverage** after test runs in `.coverage/` directory
4. **Follow C++14 patterns** when adding new code (auto, move semantics, lambdas)
5. **Include requirement tracing** in tests using `RecordProperty("req", "ATM-XXX")`

## Key Files to Understand
- `cpptest-coverage.cmake`: C/C++test build integration
- `cpptestcli.properties`: Static analysis tool configuration
- `.vscode/settings.json`: IDE integration settings
- `include/*.hxx`: Core class definitions with C++14 features
- `tests/gt/`: Manual test examples for reference

## Integration Points
- **MCP Server**: `.vscode/mcp.json` for Model Context Protocol integration
- **C/C++test Extension**: Integrated static analysis and coverage
- **GoogleTest**: XML reporting for CI/CD integration
- **CMake**: Compile commands generation for IDE support
